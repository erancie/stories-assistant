//shout out to Darwin Tech (https://www.youtube.com/watch?v=U2g--_TDYj4)
//and Mohan Raj for inspo with this component (https://www.section.io/engineering-education/speech-recognition-in-javascript/)
import React, { useEffect, useState } from 'react'
import OpenAI from 'openai-api';
import {} from 'dotenv/config';

//OpenAI GPT-3
const OPENAI_API_KEY = process.env.REACT_APP_OPENAI_API_KEY;
const openai = new OpenAI(OPENAI_API_KEY);

//Speech Rec.
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
console.log(SpeechRecognition)
const recognition = new SpeechRecognition()
console.log(recognition)
recognition.continuous = true
recognition.interimResults = true
recognition.lang = 'en-US'


export default function App() {
  //state
  const [isListening, setIsListening ] = useState(false)
  const [text, setText ] = useState('')
  const [transcript, setTranscript ] = useState(null)
  const [completion, setCompletion ] = useState('placeholder')

  //effects
  useEffect(()=>{
    //recognition
    recognition.onstart = () => console.log('recognition.onstart()')
    //onresult resolves transcript value while listening - before onend  
    recognition.onresult = event => { 
      const transcript = Array.from(event.results)
      .map(result => result[0])
      .map(result => result.transcript)
      .join('')
      setTranscript(transcript); console.log(transcript);
      recognition.onerror = event => console.log(event.error) 
    }
  }, [])

  useEffect(()=>{
    //putting here saves defining on every render, will see latest transcript when isListening stops
    const handleListen = () => {
      if(isListening){                                   
        recognition.start(); console.log('start listening event');
        recognition.onend = () => {                       
          console.log('onend callback')
          recognition.start(); console.log('restart listening');
        }
      }else {
        recognition.stop(); console.log('stop listening event'); 
        recognition.onend =()=> {console.log('onend callback')
          setText(currText => currText +' '+ transcript)
          setTranscript('')
        }
      }
    }
    handleListen(); console.log('handleListen()');
  }, [isListening])

  //pure function - can use useCallback so doesn't redefine on every render
  async function sendPrompt() {
    const gptResponse = await openai.complete({
        engine: 'ada', //davinci-instruct-beta
        maxTokens: 64,
        prompt: text
    });
    setCompletion(gptResponse.data.choices[0].text)
    console.log(`gpt: ${gptResponse.data.choices[0].text}`)
  }

  const handleTextChange = e => setText(e.target.value)

  return (
    <div className="App">

    <div className='header row '>
      <div className=' col-12 col-lg-8'>
        <h1 className='mt-5 title '>
          <span className='clever'><span className='c'>C</span>lever</span> 
          <span className='clive'> <span className='c2'>C</span>live</span>
        </h1>
        <h1 className='mt-3 pb-3 sub-title'>Speak or Type to have Clive complete your sentence.</h1>
      </div>

      <div className=' col-12 col-lg-3 col-xxl-2'>
      {/* <div className=' col-12 col-lg-4 '> */}
        <div className='mascot row'>

        {/* <svg viewBox="0 0 1215 1336" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M125.594 1091.81C107.472 1000.08 98.3082 865.003 217.402 851.965C336.496 838.927 326.571 843.833 375.282 994.517C420.179 1133.41 393.988 1191.17 288.526 1212.01C252.228 1219.18 156.12 1246.32 125.594 1091.81Z" fill="#65B1B6" stroke="black" stroke-width="5"/>
<path d="M154 1088C137.652 1011.96 145.955 889.499 212.5 889.499C279.045 889.5 202.771 916.733 247.5 1065C279.105 1169.76 360.878 1174.81 279.045 1189.45C250.879 1194.49 181.538 1216.08 154 1088Z" fill="#B8FBFF" stroke="black"/>
<path d="M401.334 1021.12C406.492 1060.68 359.228 1064.89 338.565 1069.32C306.149 1076.26 288.781 1076.5 283.181 1036.52C278.666 1004.29 315.746 1001.57 336.019 999.925C370.777 995.394 397.029 988.092 401.334 1021.12Z" fill="#737373" stroke="black"/>
<path d="M773.578 311.276C800.451 256.447 647.383 489.687 630.734 551.445L773.578 577C730.156 466.465 710.147 440.692 773.578 311.276Z" fill="black" stroke="black" stroke-width="4"/>
<path d="M774.136 309.708C805.032 257.041 652.1 490.989 636.885 553.115L675.374 552.225C698.801 440.654 737.719 371.788 774.136 309.708Z" fill="#F5F5F5"/>
<path d="M351.733 829.501C276.627 1014.27 368.726 1119.03 401.129 1155.29C457.276 1218.13 628.636 1248.86 725.306 1222.89C784.742 1206.93 984.861 1175.15 919.256 872.818C845.398 532.459 739.685 413.847 625.715 450.785C511.745 487.723 445.616 598.536 351.733 829.501Z" fill="#FFAB2E" stroke="black" stroke-width="8"/>
<path d="M366.517 830.901C295.109 1008.43 382.897 1109.17 413.783 1144.05C467.301 1204.48 586.729 1236.39 678.781 1211.5C735.379 1196.2 777.469 1176.1 714.781 885.5C644.207 558.339 735.73 431.69 627.207 467.113C518.685 502.535 455.777 608.991 366.517 830.901Z" fill="#FFCD83"/>
<path d="M922.429 1092.1C941.622 1063.62 921.61 1051.43 888.37 1038.41C874.986 1033.16 856.329 1029.8 847.924 1030.33C835.455 1031.13 820.116 1052.94 823.592 1071.18C827.233 1090.28 827.634 1085.5 864.292 1099.86C900.949 1114.22 910.045 1110.48 922.429 1092.1Z" fill="#737373" stroke="black"/>
<path d="M1063.29 905.703C941.476 863.069 908.155 974.293 891.112 1025.66C833.673 1152.9 822.443 1234.68 936.869 1276.26C1030.86 1310.42 1089.06 1309.43 1133.39 1167.33C1177.71 1025.22 1185.11 948.337 1063.29 905.703Z" fill="#65B1B6" stroke="black" stroke-width="6"/>
<path d="M995 924.5C950 924.5 930.841 998.585 913.574 1045.3C874.573 1150.81 856.279 1207.85 936.446 1239.43C1011.5 1269 954.037 1207 972 1092C994.493 948 1051.5 924.5 995 924.5Z" fill="#B8FBFF" stroke="black"/>
<path d="M846.562 746.637C904.994 533.875 766.802 501.477 620.501 489.5C474.2 477.522 355.31 515.349 349.492 684.152C342.53 886.153 502.91 949.171 579.78 951.949C645.604 953.617 796.346 929.483 846.562 746.637Z" fill="#FFD9A0" stroke="black" stroke-width="7"/>
<path d="M841.401 750.207C949.894 449.638 533.065 491.757 533.065 491.757C533.065 491.757 498.737 544.226 490.295 712.8C480.193 914.528 584.603 950.214 584.603 950.214C584.603 950.214 786.033 959.593 841.401 750.207Z" fill="#FF9900"/>
<path d="M749.499 695C768.758 553.725 639.341 540.714 580.502 541.01C476.552 541.534 397.952 562.5 397.952 718.402C397.952 859.986 523.996 903.202 563.999 905.5C604.002 907.798 725.425 871.593 749.499 695Z" fill="white"/>
<path d="M587.376 604.964C587.459 604.632 587.542 604.301 587.623 603.972C587.526 604.229 587.444 604.561 587.376 604.964Z" fill="#00FFE0"/>
<path d="M536.049 754.157C552.346 760.936 605.176 766.173 633.781 763.079C597.93 701.485 585.242 617.686 587.376 604.964C579.109 637.826 559.42 684.969 545.66 716.553C527.374 674.036 520.681 642.737 516.358 622.519C514.812 615.29 513.569 609.478 512.208 605.076C500.109 645.37 474.354 728.517 468.119 738.75C463.319 746.631 503.021 754.067 536.049 754.157Z" fill="#00FFE0"/>
<path d="M674.77 256.045C723.625 230.041 834.626 207.752 887.794 326.634C852.172 179.233 730.936 218.158 674.77 256.045Z" fill="white"/>
<path d="M603.201 89.345C714.524 44.5895 961.5 12.9097 1058.82 244.234C983.976 -25.267 723.889 28.6825 603.201 89.345Z" fill="white"/>
<path d="M653.755 163.814C728.926 134.87 897.693 116.302 971.388 273.588C923.077 82.8582 739.503 120.935 653.755 163.814Z" fill="white"/>
<path d="M477.861 737.014C470.025 737.014 506.28 657.702 512.997 629.83C515.12 643.208 504.146 690.954 519.738 742.993C502.5 737.014 490.5 737.014 477.861 737.014Z" fill="#D0FFF9"/>
<path d="M560.868 742.015C553.378 744.293 576.282 668.372 583 640.5C585.123 653.878 587.154 695.955 602.746 747.993C586.5 738.5 579 736.5 560.868 742.015Z" fill="#D0FFF9"/>
</svg> */}



<svg className='' viewBox="0 0 1215 1336" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M125.594 1091.81C107.472 1000.08 98.3082 865.003 217.402 851.965C336.496 838.927 326.571 843.833 375.282 994.517C420.179 1133.41 393.988 1191.17 288.526 1212.01C252.228 1219.18 156.12 1246.32 125.594 1091.81Z" fill="#65B1B6"/>
<path d="M154 1088C137.652 1011.96 145.955 889.499 212.5 889.499C279.045 889.5 202.771 916.733 247.5 1065C279.105 1169.76 360.878 1174.81 279.045 1189.45C250.879 1194.49 181.538 1216.08 154 1088Z" fill="#B8FBFF"/>
<path d="M401.334 1021.12C406.492 1060.68 359.228 1064.89 338.565 1069.32C306.149 1076.26 288.781 1076.5 283.181 1036.52C278.666 1004.29 315.746 1001.57 336.019 999.925C370.777 995.394 397.029 988.092 401.334 1021.12Z" fill="#737373"/>
<path d="M773.578 311.276C800.451 256.447 647.383 489.687 630.734 551.445L773.578 577C730.156 466.465 710.147 440.692 773.578 311.276Z" fill="#737373" stroke="#737373" stroke-width="4"/>
<path d="M774.136 309.708C805.032 257.041 652.1 490.989 636.885 553.115L675.374 552.225C698.801 440.654 737.719 371.788 774.136 309.708Z" fill="#F5F5F5"/>
<path d="M351.733 829.501C276.627 1014.27 368.726 1119.03 401.129 1155.29C457.276 1218.13 628.636 1248.86 725.306 1222.89C784.742 1206.93 984.861 1175.15 919.256 872.818C845.398 532.459 739.685 413.847 625.715 450.785C511.745 487.723 445.616 598.536 351.733 829.501Z" fill="#FFAB2E"/>
<path d="M366.517 830.901C295.109 1008.43 382.897 1109.17 413.783 1144.05C467.301 1204.48 586.729 1236.39 678.781 1211.5C735.379 1196.2 777.469 1176.1 714.781 885.5C644.207 558.339 735.73 431.69 627.207 467.113C518.685 502.535 455.777 608.991 366.517 830.901Z" fill="#FFCD83"/>
<path d="M922.429 1092.1C941.622 1063.62 921.61 1051.43 888.37 1038.41C874.986 1033.16 856.329 1029.8 847.924 1030.33C835.455 1031.13 820.116 1052.94 823.592 1071.18C827.233 1090.28 827.634 1085.5 864.292 1099.86C900.949 1114.22 910.045 1110.48 922.429 1092.1Z" fill="#737373"/>
<path d="M1063.29 905.703C941.476 863.069 908.155 974.293 891.112 1025.66C833.673 1152.9 822.443 1234.68 936.869 1276.26C1030.86 1310.42 1089.06 1309.43 1133.39 1167.33C1177.71 1025.22 1185.11 948.337 1063.29 905.703Z" fill="#65B1B6"/>
<path d="M995 924.5C950 924.5 930.841 998.585 913.574 1045.3C874.573 1150.81 856.279 1207.85 936.446 1239.43C1011.5 1269 954.037 1207 972 1092C994.493 948 1051.5 924.5 995 924.5Z" fill="#B8FBFF"/>
<path d="M846.562 746.637C904.994 533.875 766.802 501.477 620.501 489.5C474.2 477.522 355.31 515.349 349.492 684.152C342.53 886.153 502.91 949.171 579.78 951.949C645.604 953.617 796.346 929.483 846.562 746.637Z" fill="#FFD9A0"/>
<path d="M844.922 750.245C954.5 446.999 533.5 489.495 533.5 489.495C533.5 489.495 498.829 542.431 490.303 712.506C480.1 916.031 585.555 952.034 585.555 952.034C585.555 952.034 789.001 961.495 844.922 750.245Z" fill="#FF9900"/>
<path d="M749.499 695C768.758 553.725 639.341 540.714 580.502 541.01C476.552 541.534 397.952 562.5 397.952 718.402C397.952 859.986 523.996 903.202 563.999 905.5C604.002 907.798 725.425 871.593 749.499 695Z" fill="white"/>
<path d="M587.376 604.964C587.459 604.632 587.542 604.301 587.623 603.972C587.526 604.229 587.444 604.561 587.376 604.964Z" fill="#00FFE0"/>
<path d="M536.049 754.157C552.346 760.936 605.176 766.173 633.781 763.079C597.93 701.485 585.242 617.686 587.376 604.964C579.109 637.826 559.42 684.969 545.66 716.553C527.374 674.036 520.681 642.737 516.358 622.519C514.812 615.29 513.569 609.478 512.208 605.076C500.109 645.37 474.354 728.517 468.119 738.75C463.319 746.631 503.021 754.067 536.049 754.157Z" fill="#00FFE0"/>
<path d="M674.77 256.045C723.625 230.041 834.626 207.752 887.794 326.634C852.172 179.233 730.936 218.158 674.77 256.045Z" fill="white"/>
<path d="M603.201 89.345C714.524 44.5895 961.5 12.9097 1058.82 244.234C983.976 -25.267 723.889 28.6825 603.201 89.345Z" fill="white"/>
<path d="M653.755 163.814C728.926 134.87 897.693 116.302 971.388 273.588C923.077 82.8582 739.503 120.935 653.755 163.814Z" fill="white"/>
<path d="M477.861 737.014C470.025 737.014 506.28 657.702 512.997 629.83C515.12 643.208 504.146 690.954 519.738 742.993C502.5 737.014 490.5 737.014 477.861 737.014Z" fill="#D0FFF9"/>
<path d="M560.868 742.015C553.378 744.293 576.282 668.372 583 640.5C585.123 653.878 587.154 695.955 602.746 747.993C586.5 738.5 579 736.5 560.868 742.015Z" fill="#D0FFF9"/>
</svg>

{/* <svg className='' viewBox="0 0 798 1146" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M226.042 770.392C265.642 735.592 352.875 742.892 391.542 750.892C464.542 882.392 486.542 1116.89 477.542 1129.89C468.542 1142.89 159.137 1154.44 151.542 1129.89C130.042 1060.39 176.542 813.892 226.042 770.392Z" fill="#8EBECE" stroke="black" stroke-width="3"/>
<path d="M240.769 106.065C240.769 105.37 241.34 107.114 241.583 107.868C242.66 109.95 244.369 112.697 245.082 113.965C248.258 119.611 251.968 124.902 254.873 130.711C259.37 139.706 265.48 147.476 270.715 156.002C273.018 159.752 274.842 163.818 277 167.654C277.608 168.735 278.264 170.02 279.355 170.516C281.494 171.488 284.838 170.886 287.105 170.886C292.42 170.886 297.481 172.192 302.825 171.625C305.196 171.374 307.638 171.088 310.027 171.132C310.084 171.133 311.619 171.414 311.355 171.625C309.661 172.98 306.411 173.49 304.44 174.35C299.142 176.662 293.768 178.752 288.502 181.128C286.855 181.871 283.518 182.845 283.408 184.935C283.223 188.451 282.004 192.119 281.382 195.588C279.886 203.923 277.304 212.124 276.124 220.508C276.094 220.72 275.768 223.972 275.768 222.891C275.768 222.432 275.812 221.97 275.645 221.535C274.664 218.985 274.486 216.184 274.152 213.511C273.296 206.664 273.056 199.569 271.633 192.822C271.151 190.539 270.818 187.128 268.319 186.359C266.659 185.848 264.546 186.167 262.815 186.167C258.087 186.167 253.336 186.312 248.615 186.044C240.725 185.595 232.817 184.935 224.913 185.304C221.448 185.466 211.171 186.12 214.507 185.167C218.029 184.161 221.375 182.147 224.995 181.292C231.441 179.77 238.136 179.148 244.521 177.486C248.444 176.465 252.284 175.126 256.187 174.035C257.863 173.567 260.007 173.451 261.582 172.734C262.222 172.444 261.966 171.384 261.966 170.763C261.966 169.044 261.197 166.889 260.624 165.299C258.37 159.052 257.44 152.491 255.749 146.075C253.341 136.938 250.252 127.601 246.246 119.045C244.573 115.471 243.04 111.897 241.687 108.187C241.675 108.154 241.637 108.036 241.583 107.868C241.218 107.163 240.926 106.533 240.769 106.065Z" fill="white"/>
<path d="M231.647 739.964C232.212 739.131 232.212 739.834 232.212 740.403C234.424 735.98 240.105 734.198 244.391 733.341C256.419 730.935 268.419 728.801 280.643 727.66C293.844 726.428 306.256 727.265 319.344 728.978C334.273 730.932 349.646 730.428 364.668 731.646C374.982 732.482 385.702 733.878 395.145 738.394C396.721 739.148 397.39 739.679 398.316 741.094C403.318 748.744 406.587 756.913 410.745 765.011C412.607 768.636 409.959 770.317 407.104 773.172C397.21 783.066 386.065 791.637 376.156 801.546C375.055 802.647 365.369 814.488 363.726 812.846C362.489 811.609 362.043 809.209 361.341 807.604C358.004 799.976 355.793 792.335 350.575 785.601C348.018 782.302 339.078 767.5 334.787 771.791C330.521 776.056 325.954 780.404 321.698 784.848C312.158 794.813 305.943 806.54 298.095 817.68C296.313 820.208 295.804 822.32 293.104 821.321C289.652 820.042 283.542 817.68 274.042 812.846C264.043 807.758 263.663 807.612 254.121 803.116C241.821 797.32 229.809 790.897 217.648 784.817C215.596 783.791 211.081 782.358 211.998 779.261C214.448 770.995 218.26 763.708 222.388 756.128C225.33 750.726 228.187 745.063 231.647 739.964Z" fill="#8DB7C5" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M338.355 768.655C347.735 768.546 365.579 766.498 367.542 769.602C370.042 771.998 366.352 777.991 365.579 779.366C357.83 793.141 348.438 806.209 341.538 820.45C339.826 823.983 336.694 827.383 338.719 831.028C339.573 832.564 340.435 833.926 341.14 835.538C347.027 848.995 357.28 859.831 364.551 872.511C373.788 888.62 383.474 905.02 391.178 921.919C392.827 925.536 395.119 927.895 394.494 931.336C392.664 941.402 388.323 951.769 383.783 960.848C379.119 970.176 377.389 980.634 372.144 989.763C367.817 997.295 363.726 1004.83 359.643 1012.41C358.826 1013.93 347.403 1001.5 345.716 999.777C334.969 988.792 324.817 976.071 312.789 966.518C306.28 961.35 303.059 959.204 303.205 951.298C303.381 941.809 305.424 931.764 307.417 922.549C310.658 907.559 313.819 892.994 318.127 878.248C322.108 864.621 327.151 850.997 332.916 838.025C333.955 835.687 338.197 828.384 335.901 826.088C323.84 814.027 310.579 801.87 302.012 786.694C301.355 785.531 297.25 778.415 299.956 777.641C303.57 776.609 307.239 775.396 310.998 774.591C320.248 772.609 328.675 768.768 338.355 768.655Z" fill="#343E60" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M202.096 800.048C203.648 799.738 215.015 797.68 214.376 798.411C218.158 804.085 217.194 811.527 216.831 818.058C216.325 827.172 213.225 837.386 211.101 846.256C208.311 857.909 204.765 870.695 199.64 881.549C195.036 891.299 184.459 895.822 176.081 902.379C160.662 914.445 144.843 926.002 129.055 937.58C116.77 946.589 105.041 956.007 93.3074 965.687C91.2603 967.376 86.2443 972.2 83.3927 969.507C70.378 957.216 66.3553 934.351 62.29 917.933C58.285 901.759 53.1408 890.976 51.5423 874.392C51.0332 869.11 48.4133 857.553 54.1032 854.392C71.1624 844.914 92.6757 835.607 110.408 827.063C129.676 817.78 152.673 810.788 173.716 806.779C183.279 804.958 192.533 801.961 202.096 800.048Z" fill="#99CCDC" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M62.9261 861.628C59.0425 858.632 58.0425 856.892 53.0425 856.892C53.0425 851.266 49.0092 866.462 49.0092 872.088C49.0092 885.434 48.6587 897.295 50.8284 910.746C53.708 928.6 60.6624 949.74 72.295 963.958C77.8307 970.724 87.5779 972.123 91.9879 964.185C100.477 948.904 95.74 927.085 93.2614 910.974C91.4146 898.969 85.0655 887.503 78.071 877.819C74.1629 872.407 68.2015 865.697 62.9261 861.628Z" fill="#DCE5F0" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M26.0871 869.633C35.3826 863.618 46.5822 863.903 57.1955 863.903C66.5425 869.633 70.4845 881.428 72.9316 888.28C76.3148 897.753 78.3339 905.946 73.5684 915.477C68.2438 926.126 60.4318 934.54 48.1904 936.58C37.4995 938.362 19.8083 938.052 11.1696 930.031C1.89615 921.42 0.435573 910.279 3.34701 898.104C6.01588 886.943 16.7225 875.692 26.0871 869.633Z" fill="#F0E7DA" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M407.117 819.567C405.983 815.558 396.142 774.799 401.574 774.12C400.448 776.936 405.118 777.164 407.631 777.723C411.322 778.543 414.961 780.453 418.637 781.602C431.735 785.696 445.058 788.922 458.581 791.38C469.362 793.341 479.722 797.254 490.29 800.09C507.143 804.611 524.419 808.468 540.844 814.381C554.755 819.389 556.473 839.206 559.054 851.95C564.931 880.964 559.097 912.655 542.309 936.905C540.684 939.252 535.581 948.702 532.333 948.702C530.084 948.702 526.602 946.126 524.692 944.981C512.15 937.455 501.269 927.189 489.776 918.219C474.248 906.1 459.849 892.462 444.685 879.899C437.259 873.745 427.596 868.092 422.596 859.63C414.827 846.484 411.257 834.207 407.117 819.567Z" fill="#A9D5E4" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M538.794 831.868C539.945 828.76 543.315 819.438 547.504 819.438C549.382 823.194 554.285 828.033 556.371 831.908C561.598 841.613 561.388 855.567 562.824 866.191C564.894 881.504 561.654 896.207 558.549 911.043C556.568 920.504 552.266 929.838 546.554 937.607C544.252 940.737 539.975 949.473 535.034 948.375C524.949 946.134 524.701 918.658 524.701 911.756C524.701 895.696 525.663 879.554 529.531 863.934C532.207 853.127 534.917 842.337 538.794 831.868Z" fill="#CDE3F6" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M548.683 825.267C550.44 823.178 555.542 817.927 559.767 816.874C565.486 815.449 568.554 815.449 573.616 815.449H573.623C580.98 815.449 587.522 815.638 594.684 817.429C618.021 823.263 621.867 847.301 611.944 866.438C605.276 879.298 594.63 886.903 580.59 889.399C570.83 891.134 560.266 883.78 553.196 878.156C543.229 870.228 539.42 855.551 541.399 843.24C542.398 837.022 544.577 830.149 548.683 825.267Z" fill="#F0E7DA" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M612.042 853.892L579.042 833.892L780.042 534.392L795.042 540.892L612.042 853.892Z" fill="#343E60" stroke="black" stroke-width="3"/>
<path d="M302.906 413.675C300.579 413.694 279.891 405.066 277.794 400.899C276.96 402.887 269.489 410.208 268.288 411.954C263.544 418.856 254.726 424.679 247.537 428.722C234.591 436.005 217.21 441.673 202.79 445.048C158.085 455.511 107.764 451.84 95.0425 413.675C77.0091 359.575 98.8023 266.77 107.69 211.575C113.813 173.548 123.469 137.704 136.898 101.723L137.123 101.12C144.56 81.1942 152.128 60.9159 164.14 43.2073C172.668 30.6349 181.978 13.9868 195.316 5.83592C212.439 -4.6282 226.387 8.73344 241.341 17.1457C269.051 32.7326 293.336 56.3588 312.15 81.7588C335.069 112.698 360.573 142.572 379.861 175.974C398.326 207.949 416.042 237.392 432.042 277.892C442.354 303.993 454.616 335.716 451.042 359.392C449.459 369.884 429.519 374.196 421.904 381.811C409.177 394.539 388.577 400.911 371.453 404.628C349.222 409.453 325.712 413.494 302.906 413.675Z" fill="#4C5880"/>
<path d="M277.631 400.399C278.122 404.326 300.482 413.695 302.906 413.675C325.712 413.494 349.222 409.453 371.453 404.628C388.577 400.911 409.177 394.539 421.904 381.811C429.519 374.196 449.459 369.884 451.042 359.392C454.616 335.716 442.354 303.993 432.042 277.892C416.042 237.392 398.326 207.949 379.861 175.974C360.573 142.572 335.069 112.698 312.15 81.7588C293.336 56.3588 269.051 32.7326 241.341 17.1457C226.387 8.73344 212.439 -4.6282 195.316 5.83592C181.978 13.9868 172.668 30.6349 164.14 43.2073C152.007 61.0944 144.408 81.6034 136.898 101.723C123.469 137.704 113.813 173.548 107.69 211.575C98.8023 266.77 77.0091 359.575 95.0425 413.675C107.764 451.84 158.085 455.511 202.79 445.048C217.209 441.673 234.591 436.005 247.537 428.722C254.726 424.679 263.544 418.856 268.288 411.954C269.681 409.928 279.514 400.399 277.631 400.399Z" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M57.1845 545.524C61.9571 554.072 67.677 563.533 74.6385 570.495C84.0869 565.77 91.3528 564.482 102.49 564.482C126.822 564.482 151.013 562.97 175.27 561.308C218.936 558.317 262.026 555.326 305.382 548.656C351.383 541.579 400.054 538.594 444.429 523.895C473.383 514.304 504.888 500.906 523.724 475.792C532.941 463.502 539.132 453.995 539.132 438.796C539.132 426.206 532.654 413.071 525.603 402.886C515.444 388.211 503.618 374.909 490.277 363.051C473.536 348.17 454.214 333.107 433.74 323.8C401.153 308.988 366.218 306.808 330.895 304.801C309.152 303.566 287.071 304.418 265.63 308.351C244.166 312.287 221.651 313.48 200.658 319.625C175.437 327.006 151.25 338.207 128.629 351.443C107.939 363.548 87.3897 375.701 70.5882 393.157C52.4609 411.991 31.7969 440.732 31.7969 468.276C31.7969 479.916 33.9478 490.071 36.6823 501.43C40.5739 517.595 49.1642 531.16 57.1845 545.524Z" fill="white"/>
<path d="M57.1845 545.524C61.9571 554.072 67.677 563.533 74.6385 570.495C84.0869 565.77 91.3528 564.482 102.49 564.482C126.822 564.482 151.013 562.97 175.27 561.308C218.936 558.317 262.026 555.326 305.382 548.656C351.383 541.579 400.054 538.594 444.429 523.895C473.383 514.304 504.888 500.906 523.724 475.792C532.941 463.502 539.132 453.995 539.132 438.796C539.132 426.206 532.654 413.071 525.603 402.886C515.444 388.211 503.618 374.909 490.277 363.051C473.536 348.17 454.214 333.107 433.74 323.8C401.153 308.988 366.218 306.808 330.895 304.801C309.152 303.566 287.071 304.418 265.63 308.351C244.166 312.287 221.651 313.48 200.658 319.625C175.437 327.006 151.25 338.207 128.629 351.443C107.939 363.548 87.3897 375.701 70.5882 393.157C52.4609 411.991 31.7969 440.732 31.7969 468.276C31.7969 479.916 33.9478 490.071 36.6823 501.43C40.5739 517.595 49.1642 531.16 57.1845 545.524Z" fill="#343E60"/>
<path d="M57.1845 545.524C61.9571 554.072 67.677 563.533 74.6385 570.495C84.0869 565.77 91.3528 564.482 102.49 564.482C126.822 564.482 151.013 562.97 175.27 561.308C218.936 558.317 262.026 555.326 305.382 548.656C351.383 541.579 400.054 538.594 444.429 523.895C473.383 514.304 504.888 500.906 523.724 475.792C532.941 463.502 539.132 453.995 539.132 438.796C539.132 426.206 532.654 413.071 525.603 402.886C515.444 388.211 503.618 374.909 490.277 363.051C473.536 348.17 454.214 333.107 433.74 323.8C401.153 308.988 366.218 306.808 330.895 304.801C309.152 303.566 287.071 304.418 265.63 308.351C244.166 312.287 221.651 313.48 200.658 319.625C175.437 327.006 151.25 338.207 128.629 351.443C107.939 363.548 87.3897 375.701 70.5882 393.157C52.4609 411.991 31.7969 440.732 31.7969 468.276C31.7969 479.916 33.9478 490.071 36.6823 501.43C40.5739 517.595 49.1642 531.16 57.1845 545.524Z" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M104.035 491.367C105.932 490.277 112.263 483.995 111.008 484.151C116.619 480.885 122.821 478.187 128.003 475.959C154.326 464.643 180.85 452.47 208.592 444.976C248.652 434.154 289.209 423.56 331.02 423.18C362.388 422.894 392.539 427.929 423.259 433.326C444.72 437.096 467.917 444.002 488.315 451.699C502.576 457.08 516.65 461.032 530.154 468.234C556.911 482.504 578.893 503.701 594.417 529.574C597.802 535.215 608.219 550.326 605.106 557.717C603.698 561.062 597.77 562.894 594.918 564.482C583.092 571.065 571.457 578.702 560.928 587.197C546.89 598.525 534.436 610.225 525.937 626.364C521.37 635.036 517.917 644.905 523.348 653.923C531.32 667.159 553.146 671.188 567.234 668.579C569.103 668.233 571.953 667.011 571.493 668.621C570.504 672.083 570.007 675.518 568.361 678.81C557.801 699.93 541.592 721.636 521.386 734.303C500.263 747.544 474.276 757.481 449.357 759.524C433.431 760.829 421.869 756.413 408.519 748.626C386.009 735.495 365.27 721.748 337.534 723.99C327.844 724.773 317.784 724.361 308.221 726.244C295.912 728.669 283.45 733.362 271.56 737.351C260.343 741.114 249.722 745.974 239.241 751.214C225.53 758.07 211.794 764.404 197.485 770.088C183.954 775.463 169.356 780.861 154.601 780.861C140.052 780.861 124.949 778.615 111.008 774.514C98.8089 770.926 85.4037 766.976 75.4319 758.73C67.4234 752.108 60.6814 743.968 56.0425 734.892C53.317 729.559 51.7145 723.892 51.7145 718.185C50.6726 716.31 52.9792 717.928 53.4265 718.561C63.5042 732.839 87.3981 716.758 95.934 709.876C110.028 698.514 114.719 681.007 103.033 666.116C91.8664 651.888 69.0861 647.252 53.1759 640.561C40.4259 635.199 25.5785 629.673 15.9714 619.266C9.49307 612.247 3.60641 603.833 6.61803 594.128C11.0107 579.974 18.849 568.247 27.663 556.59C38.1834 542.676 51.5263 529.489 65.2016 518.675C77.641 508.84 90.2784 499.27 104.035 491.367Z" fill="#9F9A9A"/>
<path d="M104.035 491.367C105.932 490.277 112.263 483.995 111.008 484.151C116.619 480.885 122.821 478.187 128.003 475.959C154.326 464.643 180.85 452.47 208.592 444.976C248.652 434.154 289.209 423.56 331.02 423.18C362.388 422.894 392.539 427.929 423.259 433.326C444.72 437.096 467.917 444.002 488.315 451.699C502.576 457.08 516.65 461.032 530.154 468.234C556.911 482.504 578.893 503.701 594.417 529.574C597.802 535.215 608.219 550.326 605.106 557.717C603.698 561.062 597.77 562.894 594.918 564.482C583.092 571.065 571.457 578.702 560.928 587.197C546.89 598.525 534.436 610.225 525.937 626.364C521.37 635.036 517.917 644.905 523.348 653.923C531.32 667.159 553.146 671.188 567.234 668.579C569.103 668.233 571.953 667.011 571.493 668.621C570.504 672.083 570.007 675.518 568.361 678.81C557.801 699.93 541.592 721.636 521.386 734.303C500.263 747.544 474.276 757.481 449.357 759.524C433.431 760.829 421.869 756.413 408.519 748.626C386.009 735.495 365.27 721.748 337.534 723.99C327.844 724.773 317.784 724.361 308.221 726.244C295.912 728.669 283.45 733.362 271.56 737.351C260.343 741.114 249.722 745.974 239.241 751.214C225.53 758.07 211.794 764.404 197.485 770.088C183.954 775.463 169.356 780.861 154.601 780.861C140.052 780.861 124.949 778.615 111.008 774.514C98.8089 770.926 85.4037 766.976 75.4319 758.73C67.4234 752.108 60.6814 743.968 56.0425 734.892C53.317 729.559 51.7145 723.892 51.7145 718.185C50.6726 716.31 52.9792 717.928 53.4265 718.561C63.5042 732.839 87.3981 716.758 95.934 709.876C110.028 698.514 114.719 681.007 103.033 666.116C91.8664 651.888 69.0861 647.252 53.1759 640.561C40.4259 635.199 25.5785 629.673 15.9714 619.266C9.49307 612.247 3.60641 603.833 6.61803 594.128C11.0107 579.974 18.849 568.247 27.663 556.59C38.1834 542.676 51.5263 529.489 65.2016 518.675C77.641 508.84 90.2784 499.27 104.035 491.367Z" fill="#FFE86D"/>
<path d="M111.008 484.151C112.263 483.995 105.932 490.277 104.035 491.367C90.2784 499.27 77.641 508.84 65.2016 518.675C51.5263 529.489 38.1834 542.676 27.663 556.59C18.849 568.247 11.0107 579.974 6.61803 594.128C3.60641 603.833 9.49307 612.247 15.9714 619.266C25.5785 629.673 40.4259 635.199 53.1759 640.561C69.0861 647.252 91.8664 651.888 103.033 666.116C114.719 681.007 110.028 698.514 95.934 709.876C87.3981 716.758 63.5042 732.839 53.4265 718.561C52.9792 717.928 50.6726 716.31 51.7145 718.185C51.7145 723.892 53.317 729.559 56.0425 734.892C60.6814 743.968 67.4234 752.108 75.4319 758.73C85.4037 766.976 98.8089 770.926 111.008 774.514C124.949 778.615 140.052 780.861 154.601 780.861C169.356 780.861 183.954 775.463 197.485 770.088C211.794 764.404 225.53 758.07 239.241 751.214C249.722 745.974 260.343 741.114 271.56 737.351C283.45 733.362 295.912 728.669 308.221 726.244C317.784 724.361 327.844 724.773 337.534 723.99C365.27 721.748 386.009 735.495 408.519 748.626C421.869 756.413 433.431 760.829 449.357 759.524C474.276 757.481 500.263 747.544 521.386 734.303C541.592 721.636 557.801 699.93 568.361 678.81C570.007 675.518 570.504 672.083 571.493 668.621C571.953 667.011 569.103 668.233 567.234 668.579C553.146 671.188 531.32 667.159 523.348 653.923C517.916 644.905 521.37 635.036 525.937 626.364C534.436 610.225 546.89 598.525 560.928 587.197C571.457 578.702 583.092 571.065 594.918 564.482C597.77 562.894 603.698 561.062 605.106 557.717C608.219 550.326 597.802 535.215 594.417 529.574C578.893 503.701 556.911 482.504 530.154 468.234C516.65 461.032 502.576 457.08 488.315 451.699C467.917 444.002 444.72 437.096 423.259 433.326C392.539 427.929 362.388 422.894 331.02 423.18C289.209 423.56 248.652 434.154 208.592 444.976C180.85 452.47 154.326 464.643 128.003 475.959C119.321 479.691 107.774 484.746 100.945 491.576" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M247.645 360.202C252.125 358.282 256.647 355.944 261.285 354.056C265.205 356.15 286.335 349.285 290.457 347.453C302.068 342.292 323.888 346.524 335.787 347.846C389.581 353.823 439.282 392.086 466.426 437.326C497.685 489.425 510.54 558.983 492.317 617.701C482.662 648.814 472.428 686.534 446.908 708.991C420.794 731.972 400.488 754.605 366.637 765.339C346.519 771.718 325.529 773.007 304.701 774.232C289.373 775.133 273.47 777.246 258.191 774.468C232.784 769.849 202.795 760.609 182.09 744.405C144.236 714.781 116.998 673.902 103.471 628.247C84.8407 565.37 106.875 496.687 141.01 444.172C155.984 421.135 179.115 401.429 201.135 386.015C215.638 375.862 231.408 367.16 247.645 360.202Z" fill="#FFF9E5"/>
<path d="M276.291 350.601C266.146 350.601 256.808 356.275 247.645 360.202C231.408 367.16 215.638 375.862 201.135 386.015C179.115 401.429 155.984 421.135 141.01 444.172C106.875 496.687 84.8407 565.37 103.471 628.247C116.998 673.902 144.236 714.781 182.09 744.405C202.795 760.609 232.784 769.849 258.191 774.468C273.47 777.246 289.373 775.133 304.701 774.232C325.529 773.007 346.519 771.718 366.637 765.339C400.488 754.605 420.794 731.972 446.908 708.991C472.428 686.534 482.662 648.814 492.317 617.701C510.54 558.983 497.685 489.425 466.426 437.326C439.282 392.086 389.581 353.823 335.787 347.846C323.888 346.524 302.068 342.292 290.457 347.453C286.029 349.421 261.965 357.2 260.709 353.434" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M504.672 592.833C508.001 588.435 534.407 559.227 531.272 558.835C531.272 559.23 522.226 546.251 519.31 540.42C508.491 518.782 501.146 495.697 492.317 473.133C480.755 443.586 461.331 413.473 440.534 389.556C413.896 358.922 375.929 342.799 336.337 337.143C280.467 329.162 224.265 353.501 181.381 387.431C136.369 423.045 107.435 464.782 89.3046 519.172C78.7009 550.982 71.0058 586.902 92.4525 615.498C101.005 626.901 110.962 638.053 123.617 644.931C131.004 648.946 142.162 651.834 141.717 643.829C141.238 635.206 136.541 625.494 134.635 616.914C130.298 597.397 126.135 579.592 126.135 559.308C126.135 526.68 132.576 497.104 149.508 468.884C151.993 464.742 165.726 434.994 172.252 443.385C180.353 453.801 182.227 470.578 188.543 482.42C194.043 492.733 217.419 528.452 232.377 522.634C250.611 515.543 266.269 496.612 279.832 483.049C297.243 465.639 307.747 447.144 316.584 424.419C318.518 419.447 318.437 420.994 320.204 424.97C323.598 432.605 326.259 440.608 330.12 448.029C336.066 459.455 343.786 496.086 361.914 491.942C384.139 486.862 404.059 475.844 421.567 461.407C428.12 456.004 433.567 448.393 439.904 443.464C442.313 441.591 443.718 446.593 444.547 448.343C456.015 472.554 459.57 497.073 464.694 523.421C466.076 530.531 472.952 609.401 480.276 609.832C488.379 610.308 500.244 598.685 504.672 592.833Z" fill="#FFEB87" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M282.545 618.539C287.326 607.782 304.219 602.348 315.153 602.184C320.766 602.268 327.068 603.723 332.05 606.525C335.184 608.288 341.735 610.923 341.735 615.216C341.735 620.378 337.452 623.163 333.782 625.952C324.393 633.088 310.301 636.231 298.791 633.877C294.094 632.916 279.364 625.697 282.545 618.539Z" fill="#F1E9CF"/>
<path d="M315.662 602.18C304.75 602.18 287.401 607.613 282.545 618.539C279.364 625.697 294.094 632.916 298.791 633.877C310.301 636.231 324.393 633.088 333.782 625.952C337.452 623.163 341.735 620.378 341.735 615.216C341.735 610.923 335.184 608.288 332.05 606.525C326.915 603.637 320.378 602.18 314.639 602.18" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M255.336 640.011C254.445 639.232 257.684 644.495 258.119 645.067C261.202 649.119 265.061 651.694 269.764 653.559C281.13 658.067 295.603 660.739 307.766 659.438C323.054 657.804 341.81 653.142 352.869 641.659C354.404 640.065 355.758 638.202 357.3 636.66C358.502 635.457 353.567 642.779 352.585 643.874C348.08 648.896 341.974 652.181 336.935 656.57C332.811 660.162 327.952 662.927 322.933 665.062C313.152 669.224 304.12 671.939 293.281 671.708C285.903 671.551 273.33 667.603 267.719 662.392C263.297 658.286 259.888 652.909 256.983 647.68C256.127 646.139 253.46 639.387 254.824 638.478" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M179.672 560.268C183.171 557.893 192.042 552.892 197.542 551.892C202.042 551.893 214.308 551.509 223.127 556.178C243.474 566.95 249.546 596.228 236.931 614.971C231.235 623.433 219.421 630.758 209.721 633.375C197.197 636.755 183.044 632.373 173.65 624.173C159.694 611.988 157.69 596.574 164.846 579.809C168.145 572.078 172.612 565.059 179.672 560.268Z" fill="white" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M397.193 534.754C401.89 531.955 407.542 530.892 413.161 530.283C425.542 530.892 433.632 536.116 441.344 543.057C457.801 557.869 462.204 577.603 449.088 596.549C433.739 618.719 402.719 621.156 383.86 602.297C373.225 591.662 371.574 570.772 376.874 557.228C380.603 547.698 388.473 539.949 397.193 534.754Z" fill="white" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M184.792 585.483C187.37 580.696 193.101 573.95 198.902 573.237C204.469 570.978 211.809 576.652 215.417 580.661C221.513 587.435 225.934 599.959 218.214 607.679C208.518 617.375 188.274 617.657 183.909 602.378C182.102 596.054 181.515 591.569 184.792 585.483Z" fill="black"/>
<path d="M199 573.226C193.166 573.874 187.385 580.669 184.792 585.483C181.515 591.569 182.102 596.054 183.909 602.378C188.274 617.657 208.518 617.375 218.214 607.679C225.934 599.959 221.513 587.435 215.417 580.661C211.537 576.35 203.34 570.112 197.675 573.889" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M400.542 561.892C403.801 558.763 408.542 557.392 412.042 557.392C414.859 557.392 418.245 557.82 422.28 559.838C426.042 561.719 428.542 563.392 432.071 567.42C434.542 572.892 433.77 576.949 433.543 580.009C433.033 586.892 426.354 591.24 420.623 593.444C407.795 598.378 395.115 590.705 395.115 576.585C395.115 571.891 396.844 564.917 400.542 561.892Z" fill="black" stroke="black" stroke-width="3" stroke-linecap="round"/>
<path d="M187.542 193.892L227.542 71.3916L321.542 170.892L273.042 253.892L187.542 193.892Z" fill="#8EBECE" stroke="black" stroke-width="3"/>
<path d="M251.638 166.496L234.542 92.3911L267.467 160.391L309.542 170.892L273.042 173.391L270.042 231.891L257.542 176.987L211.543 184.891L251.638 166.496Z" fill="white" stroke="black" stroke-width="3"/>
</svg> */}




        </div>
      </div>
    </div>


      <div className='row justify-content-center align-items-center px-3 mt-5'>

        <div className='box-bg text-box col-10 col-lg-6'>

          <div className='listen-buttons-bg mt-5 pb-2 pt-3 m-auto row '>
            <div className='listen-buttons m-auto row align-items-center justify-content-center'>
              <div className='mb-2 col-12 col-lg-6 '>
                <button className={`button btn  btn-lg px-4`}
                        onClick = {()=> setIsListening(latest => !latest)} >
                  {!isListening ? 'Listen' : 'Stop'} 
                </button>
              </div>
            
              <div className='listening mb-2 col-12 col-lg-6 '>
                {isListening ? <i style={{color: 'rgb(170, 177, 254)'}}>Listening</i> : <i>Not Listening</i>}
              </div>
            </div>
          </div>

          <div className='interim-text p-4 m-auto' style={{height: '100px'}}>
            {isListening ? <p>{transcript}</p> : null}
          </div>

          <textarea
            className='text p-3 container' 
            type="text" 
            name='text' 
            onChange={handleTextChange} 
            value={text}>
          </textarea>
        </div>
        
        <div className='request-box col-10 col-lg-2 row'>
          <button className={`button btn col-6 col-lg-12 btn-lg my-3`}
                      onClick={sendPrompt} >
            <span className='complete'>Complete</span>
            <svg className='arrow-down' viewBox="0 0 111 64"  xmlns="http://www.w3.org/2000/svg">
              <path d="M70.3108 38.7437L53.0209 48.8676C52.3736 49.2493 51.8982 49.9063 51.7702 50.7135C51.5391 52.173 52.534 53.576 53.9925 53.8411L107.499 63.6031L107.933 63.6434C109.409 63.6698 110.602 62.4857 110.594 61.0049L110.324 7.74414C110.311 6.983 109.987 6.22221 109.363 5.6809C108.234 4.70735 106.55 4.82067 105.607 5.93164L94.5697 18.9379C91.9781 16.4117 88.8184 13.9286 85.237 11.643C75.8954 5.67494 63.5404 0.970783 50.6487 0.305464C37.63 -0.367087 24.0668 3.05459 12.4624 13.3808C8.23308 17.1387 4.27422 21.8145 0.715106 27.5326C0.0854835 28.3931 0.0212279 29.6027 0.64341 30.5742C1.45171 31.8354 3.11115 32.2228 4.34587 31.4387C21.0039 20.909 34.6722 19.7105 45.8103 22.9346C55.7666 25.815 63.862 32.2537 70.3108 38.7437Z" />
            </svg>
          </button>

          <button className={`button btn col-6 col-lg-12 btn-lg my-3`}
                  onClick={()=>setText(prev=>prev+' '+completion)} >
            <svg className='arrow-up' viewBox="0 0 111 65"  xmlns="http://www.w3.org/2000/svg">
              <path d="M40.3047 25.7226L57.5949 15.5991C58.2422 15.2174 58.7176 14.5604 58.8457 13.7533C59.0768 12.2938 58.0819 10.8907 56.6234 10.6257L3.11703 0.862392L2.68275 0.822057C1.20727 0.795623 0.0140855 1.9797 0.0224695 3.46048L0.290625 56.7212C0.304196 57.4824 0.627958 58.2432 1.25197 58.7845C2.38059 59.7581 4.065 59.6448 5.00747 58.5339L16.0454 45.5278C18.6369 48.0541 21.7965 50.5373 25.3779 52.823C34.7193 58.7913 47.0742 63.4957 59.9659 64.1613C72.9846 64.8342 86.5479 61.4128 98.1525 51.0869C102.382 47.3292 106.341 42.6534 109.9 36.9354C110.53 36.0749 110.594 34.8653 109.972 33.8937C109.164 32.6326 107.504 32.2451 106.269 33.0292C89.6112 43.5585 75.9429 44.7567 64.8048 41.5323C54.8487 38.6516 46.7534 32.2128 40.3047 25.7226Z" />
            </svg>
            <span className='add'>Add</span>
          </button>
        </div>

        <div className='box-bg completion-box col-10 col-lg-4'>
          <div className='container'>
            <div className='completion'>{completion}</div>
          </div>
        </div>
        
      </div>
    </div>
  )
}
